{% extends 'layouts/base.html' %}
{% block title %}Enter - {{ block.super }}{% endblock %}
{% block content %}
  <h2>Field Trip Location:</h2>
  <form>
  <select name="Location">
    <option value="unset">Pick a site</option>
    {% for loc in loc %}
      <option value="{{loc.idlocation}}">{{loc.location}}</option>
    {% endfor %}
  </select>
  <div id="Checkboxes" class=hidden>
    {% for sit in sit %}
      <input type="checkbox" name="site" value="{{sit.Site}}">{{sit.site}}<br>
    {% endfor %}
  </div>
</form>
  <script>
  $(function() {
    var $site = $('div[id="Checkboxes"]');
    var $loc = $('select[name="Location"]');

    $loc.change(function(){
      var val = $(this).val();
      if(val == "unset"){
        $site.addClass("hidden");
        return;
      }

      console.log(val + " selected");

      $.get("/api/locations/" + val, function(data){
        $site.empty();
        console.log(data);
        $.each(data["sites"], function(idx, val) {
          $site.append("<input type='checkbox' name='site' value='" + val.idsite + "'> "+ val.site +"<br>")
        });
        $site.removeClass("hidden");
      })
    })
  });
  </script>
{% endblock %}
